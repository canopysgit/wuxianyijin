{
  "permissions": {
    "allow": [
      "Bash(npx create-next-app:*)",
      "Bash(npm install)",
      "Bash(npm install:*)",
      "Bash(npm run dev:*)",
      "Bash(npm test)",
      "Bash(npm run lint)",
      "Bash(npm run format:*)",
      "Bash(npm run build:*)",
      "Bash(npm search:*)",
      "Bash(export SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\")",
      "Bash(export:*)",
      "Bash(curl:*)",
      "Bash(node:*)",
      "Bash(git init:*)",
      "Bash(git add:*)",
      "Bash(git rm:*)",
      "Bash(git commit:*)",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczNTQ0NzY2MiwiZXhwIjoyMDUxMDIzNjYyfQ.F7x2n6XYOV7e3n6hm-7i_7HkFfvqvJbY6kWZnZhiZko\" npx supabase db reset --db-url postgresql://postgres:[YOUR-PASSWORD]@db.abtvvtnzethqnxqjsvyn.supabase.co:5432/postgres)",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczNTQ0NzY2MiwiZXhwIjoyMDUxMDIzNjYyfQ.F7x2n6XYOV7e3n6hm-7i_7HkFfvqvJbY6kWZnZhiZko\" node create_import_logs.js)",
      "Bash(echo $SUPABASE_URL)",
      "Bash(npx:*)",
      "Bash(grep:*)",
      "Bash(echo:*)",
      "Bash(taskkill:*)",
      "Bash(cmd /c:*)",
      "Bash(del nul)",
      "Bash(git remote add:*)",
      "Bash(git push:*)",
      "WebFetch(domain:github.com)",
      "mcp__ide__executeCode",
      "WebSearch",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczNTQ0NzY2MiwiZXhwIjoyMDUxMDIzNjYyfQ.F7x2n6XYOV7e3n6hm-7i_7HkFfvqvJbY6kWZnZhiZko\" node test_new_calculator.js)",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczNTQ0NzY2MiwiZXhwIjoyMDUxMDIzNjYyfQ.F7x2n6XYOV7e3n6hm-7i_7HkFfvqvJbY6kWZnZhiZko\" node -e \"\nconst { createClient } = require(''@supabase/supabase-js'');\nconst supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\n(async () => {\n  const { data, error } = await supabase.from(''salary_records'').select(''employee_id'').limit(10);\n  if (error) console.error(''Error:'', error.message);\n  else console.log(''前10个员工ID:'', data.map(r => r.employee_id));\n})();\n\")",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTczNTQ0NzY2MiwiZXhwIjoyMDUxMDIzNjYyfQ.F7x2n6XYOV7e3n6hm-7i_7HkFfvqvJbY6kWZnZhiZko\" node batch_calculate_df2127.js)",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node -e \"\nconst { createClient } = require(''@supabase/supabase-js'');\nconst supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\n(async () => {\n  console.log(''检查计算结果表是否存在...'');\n  const tables = [\n    ''calculate_result_2023_H1_wide'', ''calculate_result_2023_H1_narrow'',\n    ''calculate_result_2023_H2_wide'', ''calculate_result_2023_H2_narrow'',\n    ''calculate_result_2024_H1_wide'', ''calculate_result_2024_H1_narrow'',\n    ''calculate_result_2024_H2_wide'', ''calculate_result_2024_H2_narrow''\n  ];\n  \n  for (const table of tables) {\n    try {\n      const { data, error } = await supabase.from(table).select(''count(*)'', { count: ''exact'', head: true });\n      if (error) {\n        console.log(''FAIL '' + table + '': '' + error.message);\n      } else {\n        console.log(''OK '' + table + '': '' + data + '' records'');\n      }\n    } catch (e) {\n      console.log(''ERROR '' + table + '': '' + e.message);\n    }\n  }\n})();\n\")",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node -e \"\nconst { createClient } = require(''@supabase/supabase-js'');\nconst supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\n(async () => {\n  console.log(''检查数据库中实际存在的计算结果表...'');\n  const possibleTables = [\n    ''calculation_results_wide_2023h1'', ''calculation_results_narrow_2023h1'',\n    ''calculation_results_wide_2023h2'', ''calculation_results_narrow_2023h2'',\n    ''calculation_results_wide_2024h1'', ''calculation_results_narrow_2024h1'',\n    ''calculation_results_wide_2024h2'', ''calculation_results_narrow_2024h2''\n  ];\n  \n  for (const table of possibleTables) {\n    try {\n      const { data, error } = await supabase.from(table).select(''count(*)'', { count: ''exact'', head: true });\n      if (error) {\n        console.log(''❌ '' + table + '': '' + error.message);\n      } else {\n        console.log(''✅ '' + table + '': 存在'');\n      }\n    } catch (e) {\n      console.log(''ERROR '' + table + '': '' + e.message);\n    }\n  }\n})();\n\")",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node -e \"\nconst { createClient } = require(''@supabase/supabase-js'');\nconst supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\n(async () => {\n  console.log(''检查数据库中实际存在的计算结果表...'');\n  const expectedTables = [\n    ''calculate_result_2023_h1_wide'', ''calculate_result_2023_h1_narrow'',\n    ''calculate_result_2023_h2_wide'', ''calculate_result_2023_h2_narrow'',\n    ''calculate_result_2024_h1_wide'', ''calculate_result_2024_h1_narrow'',\n    ''calculate_result_2024_h2_wide'', ''calculate_result_2024_h2_narrow''\n  ];\n  \n  const existingTables = [];\n  \n  for (const table of expectedTables) {\n    try {\n      const { data, error } = await supabase.from(table).select(''count(*)'', { count: ''exact'', head: true });\n      if (!error) {\n        console.log(''存在表: '' + table);\n        existingTables.push(table);\n      } else {\n        console.log(''不存在: '' + table + '' - '' + error.message);\n      }\n    } catch (e) {\n      console.log(''错误: '' + table + '' - '' + e.message);\n    }\n  }\n  \n  console.log(''\\n实际存在的表数量: '' + existingTables.length);\n})();\n\")",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node -e \"\nconst { createClient } = require(''@supabase/supabase-js'');\nconst supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\n(async () => {\n  console.log(''检查SQL文件中的表名是否存在...'');\n  const sqlTables = [\n    ''calculation_results_wide_2023h1'', ''calculation_results_narrow_2023h1'',\n    ''calculation_results_wide_2023h2'', ''calculation_results_narrow_2023h2'',\n    ''calculation_results_wide_2024h1'', ''calculation_results_narrow_2024h1'',\n    ''calculation_results_wide_2024h2'', ''calculation_results_narrow_2024h2''\n  ];\n  \n  for (const table of sqlTables) {\n    try {\n      const { data, error } = await supabase.from(table).select(''count(*)'', { count: ''exact'', head: true });\n      if (!error) {\n        console.log(''✅ 存在: '' + table);\n      } else {\n        console.log(''❌ 不存在: '' + table);\n      }\n    } catch (e) {\n      console.log(''ERROR '' + table + '': '' + e.message);\n    }\n  }\n})();\n\")",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node batch_calculate_df2127.js)",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node -e \"\nconst { createClient } = require(''@supabase/supabase-js'');\nconst supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\n(async () => {\n  console.log(''检查政策规则数据的详细内容...'');\n  const { data: rules, error } = await supabase.from(''policy_rules'').select(''*'').eq(''year'', 2023).eq(''period'', ''H1'');\n  if (error) {\n    console.log(''查询失败:'', error.message);\n  } else if (rules.length > 0) {\n    console.log(''2023年H1政策规则:'');\n    console.log(JSON.stringify(rules[0], null, 2));\n  } else {\n    console.log(''没有找到2023年H1的政策规则'');\n  }\n})();\n\")",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node test_single_calculation.js)",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node -e \"\nconst { createClient } = require(''@supabase/supabase-js'');\nconst supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\n(async () => {\n  console.log(''🔍 逐步测试表字段要求...'');\n  \n  // 尝试逐步添加字段来了解表结构\n  const testData = {\n    employee_id: ''TEST-001''\n  };\n  \n  const { data, error } = await supabase\n    .from(''calculate_result_2023_h1_wide'')\n    .insert([testData])\n    .select();\n    \n  if (error) {\n    console.log(''错误:'', error.message);\n    console.log(''详情:'', error.details);\n    console.log(''提示:'', error.hint);\n  } else {\n    console.log(''成功插入:'', data);\n  }\n})();\n\")",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node -e \"\nconst { createClient } = require(''@supabase/supabase-js'');\nconst supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\n(async () => {\n  console.log(''🔍 验证DF-2127计算结果...'');\n  \n  const periods = [\n    { name: ''2023年H1'', table: ''calculate_result_2023_h1_wide'' },\n    { name: ''2023年H2'', table: ''calculate_result_2023_h2_wide'' },\n    { name: ''2024年H1'', table: ''calculate_result_2024_h1_wide'' },\n    { name: ''2024年H2'', table: ''calculate_result_2024_h2_wide'' }\n  ];\n  \n  for (const period of periods) {\n    const { data, error } = await supabase\n      .from(period.table)\n      .select(''calculation_month, employee_category, reference_wage_base, reference_wage_category, theoretical_total'')\n      .eq(''employee_id'', ''DF-2127'')\n      .order(''calculation_month'');\n      \n    if (error) {\n      console.log(''❌ '' + period.name + '': '' + error.message);\n    } else {\n      console.log(''\\n✅ '' + period.name + '' ('' + data.length + ''条记录):'');\n      data.forEach(record => {\n        const month = new Date(record.calculation_month).toLocaleDateString(''zh-CN'', { year: ''numeric'', month: ''long'' });\n        console.log(''  '' + month + '': '' + record.employee_category + ''类, 参考工资¥'' + record.reference_wage_base.toFixed(2) + '' ('' + record.reference_wage_category + ''), 总计¥'' + record.theoretical_total.toFixed(2));\n      });\n    }\n  }\n})();\n\")",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node -e \"\nconst { createClient } = require(''@supabase/supabase-js'');\nconst supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\n(async () => {\n  console.log(''🗑️ 清理DF-2127现有数据...'');\n  const tables = [''calculate_result_2023_h1_wide'', ''calculate_result_2023_h2_wide'', ''calculate_result_2024_h1_wide'', ''calculate_result_2024_h2_wide''];\n  \n  for (const table of tables) {\n    const { error } = await supabase.from(table).delete().eq(''employee_id'', ''DF-2127'');\n    if (error) {\n      console.log(''❌ 删除'' + table + ''失败:'', error.message);\n    } else {\n      console.log(''✅ 已清理'' + table + ''中的DF-2127数据'');\n    }\n  }\n})();\n\")",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node -e \"\nconst { createClient } = require(''@supabase/supabase-js'');\nconst supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\n(async () => {\n  console.log(''🔍 查看DF-2127的实际工资记录...'');\n  const { data, error } = await supabase\n    .from(''salary_records'')\n    .select(''employee_id, salary_month, basic_salary, gross_salary'')\n    .eq(''employee_id'', ''DF-2127'')\n    .order(''salary_month'');\n    \n  if (error) {\n    console.log(''❌ 查询失败:'', error.message);\n  } else {\n    console.log(''✅ DF-2127工资记录:'');\n    data.forEach(record => {\n      console.log(''  '' + record.salary_month + '': 基本¥'' + record.basic_salary + '', 应发¥'' + record.gross_salary);\n    });\n  }\n})();\n\")",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node -e \"\nconst { createClient } = require(''@supabase/supabase-js'');\nconst supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\n(async () => {\n  console.log(''🔍 验证2023年H1数据格式是否正确...'');\n  const { data, error } = await supabase\n    .from(''calculate_result_2023_h1_wide'')\n    .select(''employee_id, calculation_month, employee_category, reference_wage_base, theoretical_total'')\n    .eq(''employee_id'', ''DF-2127'')\n    .order(''calculation_month'');\n    \n  if (error) {\n    console.log(''❌ 查询失败:'', error.message);\n  } else {\n    console.log(''✅ 2023年H1计算结果:'');\n    data.forEach(record => {\n      console.log(''  '' + record.calculation_month + '': '' + record.employee_category + ''类, ¥'' + record.reference_wage_base + '' → ¥'' + record.theoretical_total.toFixed(2));\n    });\n    console.log(''\\n📊 数据验证:'');\n    console.log(''  期望记录数: 6条 (202301-202306)'');\n    console.log(''  实际记录数: '' + data.length + ''条'');\n    console.log(''  格式验证: '' + (data.every(r => /^\\d{6}$/.test(r.calculation_month)) ? ''✅ YYYYMM格式正确'' : ''❌ 格式错误''));\n  }\n})();\n\")",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node -e \"\nconst { createClient } = require(''@supabase/supabase-js'');\nconst supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\n(async () => {\n  console.log(''🧪 测试YYYYMM格式插入...'');\n  \n  const testData = {\n    employee_id: ''DF-2127'',\n    calculation_month: ''202301'',  // YYYYMM格式\n    employee_category: ''A'',\n    reference_wage_base: 21535.13,\n    reference_wage_category: ''2022年平均工资'',\n    pension_base_floor: 3958,\n    pension_base_cap: 22941,\n    pension_adjusted_base: 21535.13,\n    medical_base_floor: 3958,\n    medical_base_cap: 22941,\n    medical_adjusted_base: 5626,\n    unemployment_base_floor: 3958,\n    unemployment_base_cap: 22941,\n    unemployment_adjusted_base: 21535.13,\n    injury_base_floor: 0,\n    injury_base_cap: 999999,\n    injury_adjusted_base: 21535.13,\n    hf_base_floor: 1720,\n    hf_base_cap: 23634,\n    hf_adjusted_base: 21535.13,\n    pension_payment: 3014.92,\n    medical_payment: 309.43,\n    unemployment_payment: 68.91,\n    injury_payment: 21.54,\n    hf_payment: 1076.76,\n    theoretical_total: 4491.55\n  };\n  \n  const { data, error } = await supabase\n    .from(''calculate_result_2023_h1_wide'')\n    .insert([testData])\n    .select();\n    \n  if (error) {\n    console.log(''❌ 插入失败:'', error.message);\n    console.log(''详情:'', error.details);\n  } else {\n    console.log(''✅ 插入成功，记录ID:'', data[0].id);\n    console.log(''📋 calculation_month值:'', data[0].calculation_month);\n  }\n})();\n\")",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node -e \"\nconst { createClient } = require(''@supabase/supabase-js'');\nconst supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\n(async () => {\n  console.log(''🔍 检查表之间的关系...'');\n  \n  // 检查calculate_result表的结构\n  const { data: calcData, error: calcError } = await supabase\n    .from(''calculate_result_2023_h1_wide'')\n    .select(''*'')\n    .limit(1);\n    \n  if (calcError) {\n    console.log(''❌ 计算结果表查询失败:'', calcError.message);\n  } else {\n    console.log(''✅ 计算结果表字段:'', Object.keys(calcData[0] || {}));\n  }\n  \n  // 检查policy_rules表的结构\n  const { data: policyData, error: policyError } = await supabase\n    .from(''policy_rules'')\n    .select(''*'')\n    .limit(1);\n    \n  if (policyError) {\n    console.log(''❌ 政策规则表查询失败:'', policyError.message);\n  } else {\n    console.log(''✅ 政策规则表字段:'', Object.keys(policyData[0] || {}));\n  }\n})();\n\")",
      "Bash(SUPABASE_URL=\"https://abtvvtnzethqnxqjsvyn.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFidHZ2dG56ZXRocW54cWpzdnluIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MjQ4OTA4NiwiZXhwIjoyMDY4MDY1MDg2fQ.ZpmsQkZcaGYf8xalik0G1HXPTVopADj4k6eV_jaX3r8\" node -e \"\nconst { createClient } = require(''@supabase/supabase-js'');\nconst supabase = createClient(process.env.SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE_KEY);\n(async () => {\n  console.log(''🔍 检查如何关联两个表...'');\n  \n  // 查看计算结果表中是否有period信息\n  const { data: sampleCalc, error } = await supabase\n    .from(''calculate_result_2023_h1_wide'')\n    .select(''calculation_month'')\n    .limit(1);\n    \n  if (!error && sampleCalc.length > 0) {\n    console.log(''calculation_month样例:'', sampleCalc[0].calculation_month);\n    \n    // 检查如何从calculation_month推导政策规则\n    const calcMonth = sampleCalc[0].calculation_month;\n    const year = parseInt(calcMonth.substring(0, 4));\n    const month = parseInt(calcMonth.substring(4, 6));\n    const period = month <= 6 ? ''H1'' : ''H2'';\n    \n    console.log(''推导的年份:'', year);\n    console.log(''推导的期间:'', period);\n    \n    // 查询对应的政策规则\n    const { data: policyData, error: policyError } = await supabase\n      .from(''policy_rules'')\n      .select(''*'')\n      .eq(''year'', year)\n      .eq(''period'', period);\n      \n    if (policyError) {\n      console.log(''❌ 政策规则查询失败:'', policyError.message);\n    } else {\n      console.log(''✅ 找到政策规则:'', policyData.length, ''条'');\n      if (policyData.length > 0) {\n        console.log(''政策规则详情:'', policyData[0]);\n      }\n    }\n  }\n})();\n\")",
      "WebFetch(domain:rsj.sh.gov.cn)",
      "WebFetch(domain:www.51shebao.com)"
    ],
    "deny": [],
    "ask": [],
    "additionalDirectories": [
      "C:\\c\\96AICoding"
    ]
  }
}